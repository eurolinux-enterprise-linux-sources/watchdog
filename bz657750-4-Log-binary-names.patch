From afa8f1ba161e064573e077688ee07b786644a94b Mon Sep 17 00:00:00 2001
From: Lon Hohberger <lhh@redhat.com>
Date: Mon, 24 Jan 2011 16:43:52 -0500
Subject: [PATCH 4/4] Log which test / repair binaries failed

Signed-off-by: Lon Hohberger <lhh@redhat.com>
---
 src/test_binary.c |    4 ++--
 src/watchdog.c    |    2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/test_binary.c b/src/test_binary.c
index 9c969f9..e8077ad 100644
--- a/src/test_binary.c
+++ b/src/test_binary.c
@@ -156,13 +156,13 @@ int check_bin(char *tbinary, time_t timeout, int version)
 		if (WIFEXITED(result) != 0) {
 			/* if one of the scripts returns an error code just return that code */
 #if USE_SYSLOG
-			syslog(LOG_ERR, "test binary returned %d", WEXITSTATUS(result));
+			syslog(LOG_ERR, "test binary %s returned %d", tbinary, WEXITSTATUS(result));
 #endif				/* USE_SYSLOG */
 		    	return (WEXITSTATUS(result));
 		} else if (WIFSIGNALED(result) != 0)  {
 			/* if one of the scripts was killed return ECHKILL */
 #if USE_SYSLOG
-			syslog(LOG_ERR, "test binary was killed by uncaught signal %d", WTERMSIG(result));
+			syslog(LOG_ERR, "test binary %s was killed by uncaught signal %d", tbinary, WTERMSIG(result));
 #endif				/* USE_SYSLOG */
 		    	return (ECHKILL);
 		}
diff --git a/src/watchdog.c b/src/watchdog.c
index 24b921b..9948d55 100644
--- a/src/watchdog.c
+++ b/src/watchdog.c
@@ -181,7 +181,7 @@ static int repair(char *rbinary, int result, char *name, int version)
     ret = WEXITSTATUS(result);
     if (ret != 0) {
 #if USE_SYSLOG
-	syslog(LOG_ERR, "repair binary returned %d", ret);
+	syslog(LOG_ERR, "repair binary %s returned %d", rbinary, ret);
 #endif				/* USE_SYSLOG */
 
 	if (ret == ERESET) /* repair script says force hard reset, we give it a try */
-- 
1.7.2.3

